{"version":3,"sources":["../src/view.js"],"names":["SELECTOR","MAIN","LOADING","TEMPLATE","allowAccess","window","location","reload","preventAccess","Str","get_strings","key","component","then","Strings","Notification","addNotification","message","type","catch","exception","addLoadingAlert","Templates","render","html","js","alertRegion","document","querySelector","prependNodeContents","clearLoadingAlert","alert","replaceNode"],"mappings":"whBAwBA,uDACA,OACA,O,yiBAGMA,CAAAA,CAAQ,CAAG,CACbC,IAAI,CAAE,cADO,CAEbC,OAAO,CAAE,cAFI,C,CAMXC,CAAQ,CAAG,CACbD,OAAO,CAAE,wBADI,C,eAOU,QAAdE,CAAAA,WAAc,EAAM,CAC7BC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,EACH,C,CAKM,GAAMC,CAAAA,CAAa,CAAG,UAAM,CAE/BC,CAAG,CAACC,WAAJ,CAAgB,CACZ,CAACC,GAAG,CAAE,aAAN,CAAqBC,SAAS,CAAE,gBAAhC,CADY,CAAhB,EAGCC,IAHD,CAGM,SAACC,CAAD,CAAa,CACfC,UAAaC,eAAb,CAA6B,CACzBC,OAAO,CAAEH,CAAO,CAAC,CAAD,CADS,CAEzBI,IAAI,CAAE,OAFmB,CAA7B,EAIA,MAAOJ,CAAAA,CACV,CATD,EASGK,KATH,CASSJ,UAAaK,SATtB,CAUH,CAZM,C,kBAmBA,GAAMC,CAAAA,CAAe,CAAG,UAAM,CACjC,MAAOC,CAAAA,CAAS,CAACC,MAAV,CAAiBpB,CAAQ,CAACD,OAA1B,CAAmC,EAAnC,EAAuCW,IAAvC,CAA4C,SAACW,CAAD,CAAOC,CAAP,CAAc,CAC7D,GAAMC,CAAAA,CAAW,CAAGrB,MAAM,CAACsB,QAAP,CAAgBC,aAAhB,CAA8B5B,CAAQ,CAACC,IAAvC,CAApB,CACA,MAAOqB,CAAAA,CAAS,CAACO,mBAAV,CAA8BH,CAA9B,CAA2CF,CAA3C,CAAiDC,CAAjD,CACV,CAHM,EAGJN,KAHI,CAGEJ,UAAaK,SAHf,CAIV,CALM,C,oBAUA,GAAMU,CAAAA,CAAiB,CAAG,UAAM,CACnC,GAAMC,CAAAA,CAAK,CAAG1B,MAAM,CAACsB,QAAP,CAAgBC,aAAhB,CAA8B5B,CAAQ,CAACE,OAAvC,CAAd,CACA,GAAI6B,CAAJ,CAAW,CACPT,CAAS,CAACU,WAAV,CAAsBD,CAAtB,CAA6B,EAA7B,CAAiC,EAAjC,CACH,CACJ,CALM,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage the quiz views.\n *\n * @module     quizaccess_seb/view\n * @author     Andrew Madden <andrewmadden@catalyst-au.net>\n * @copyright  2021 Catalyst IT\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Notification from \"core/notification\";\nimport * as Str from \"core/str\";\nimport * as Templates from \"core/templates\";\n\n/** @var SELECTOR List of CSS selectors. */\nconst SELECTOR = {\n    MAIN: '#region-main',\n    LOADING: '.seb-loading',\n};\n\n/** @var Template List of mustache templates. */\nconst TEMPLATE = {\n    LOADING: 'quizaccess_seb/loading',\n};\n\n/**\n * Manages view when access has been granted.\n */\nexport const allowAccess = () => {\n    window.location.reload();\n};\n\n/**\n * Manages view when access has been prevented.\n */\nexport const preventAccess = () => {\n    // Give information to end user why access was prevented.\n    Str.get_strings([\n        {key: 'invalidkeys', component: 'quizaccess_seb'},\n    ])\n    .then((Strings) => {\n        Notification.addNotification({\n            message: Strings[0],\n            type: \"error\"\n        });\n        return Strings;\n    }).catch(Notification.exception);\n};\n\n/**\n * Add an alert to page to inform that Safe Exam Browser access is being checked.\n *\n * @return {Promise}\n */\nexport const addLoadingAlert = () => {\n    return Templates.render(TEMPLATE.LOADING, {}).then((html, js) => {\n        const alertRegion = window.document.querySelector(SELECTOR.MAIN);\n        return Templates.prependNodeContents(alertRegion, html, js);\n    }).catch(Notification.exception);\n};\n\n/**\n * Remove the Safe Exam Browser access check alert from the page.\n */\nexport const clearLoadingAlert = () => {\n    const alert = window.document.querySelector(SELECTOR.LOADING);\n    if (alert) {\n        Templates.replaceNode(alert, '', '');\n    }\n};\n"],"file":"view.min.js"}